<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nodes.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activeFromParent">activeFromParent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#activeTagButton">activeTagButton</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#changeView">changeView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#closeRecord">closeRecord</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#displayFromIndex">displayFromIndex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#displayNodes">displayNodes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#explodeNode">explodeNode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#filterOff">filterOff</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#filterOn">filterOn</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getFiltedNodes">getFiltedNodes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getNodeNetwork">getNodeNetwork</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#hideFromIndex">hideFromIndex</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#hideNodes">hideNodes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#highlightNodes">highlightNodes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#isolate">isolate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#isolateByElement">isolateByElement</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#openRecord">openRecord</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#registerView">registerView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#resetNodes">resetNodes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#saveView">saveView</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#setFilters">setFilters</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#translate">translate</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#unactiveFromParent">unactiveFromParent</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#unactiveTagsButton">unactiveTagsButton</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#unlightNodes">unlightNodes</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">nodes.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const resetHighlightBtn = document.getElementById('reset-highlight'); // anti highlightNodes() function btn

/**
 * Apply highlightColor (from config) to somes nodes and their links
 * @param {array} nodeIds - List of nodes ids
 */

function highlightNodes(nodeIds) {

    let elts = getNodeNetwork(nodeIds);
    if (elts.length === 0) { return; }

    elts = explodeNode(elts);

    for (const elt of elts) {

        switch (elt.tagName) {
            case 'circle':
                elt.style.stroke = 'var(--highlight)';
                elt.style.fill = 'var(--highlight)';
                break;
                
            case 'text':
                elt.style.fill = 'var(--highlight)';

                break;

            case 'line':
                elt.style.stroke = 'var(--highlight)';
                break;
        }
    }

    view.highlightedNodes = view.highlightedNodes.concat(nodeIds);
    resetHighlightBtn.style.display = 'block';
}

/**
 * remove highlightColor (from config) from all highlighted nodes and their links
 */

function unlightNodes() {
    if (view.highlightedNodes.length === 0) { return; }

    let elts = getNodeNetwork(view.highlightedNodes);
    if (elts.length === 0) { return; }

    elts = explodeNode(elts);

    for (const elt of elts) {
        elt.style.stroke = null;
        elt.style.fill = null;
    }

    if (view.activeTag !== undefined) {
        // if there is an active tag, remove the highlight of its button
        document.querySelectorAll('[data-tag="' + view.activeTag + '"]')
            .forEach(button => { button.classList.remove('active'); });
    }

    view.highlightedNodes = [];
    resetHighlightBtn.style = null;
}

/**
 * Get 'circle' &amp; 'text' elts from a 'g' one
 * @param {array} nodeNetworkElts - List of elts from getNodeNetwork()
 */

function explodeNode(nodeNetworkElts) {
    for (let i = 0; i &lt; nodeNetworkElts.length; i++) {
        if (nodeNetworkElts[i].tagName === 'g') {
            nodeNetworkElts = nodeNetworkElts
                .concat(Array.from(nodeNetworkElts[i].childNodes))
            nodeNetworkElts.splice(i, 1);
        }
    }

    return nodeNetworkElts;
}

/**
 * Get nodes
 * Get links of nodes if their source and their target are not hidden
 * @param {array} nodeIds - List of nodes ids
 * @returns {array} - DOM elts : nodes and their links
 */

function getNodeNetwork(nodeIds) {
    let nodes = [], links = [];

    const diplayedNodes = index.filter(function(item) {
        if (item.hidden === true) {
            return false; }

        return item;
    }).map(item => item.id);

    for (const nodeId of nodeIds) {
        // get nodes DOM element
        var node = document.querySelector('[data-node="' + nodeId + '"]');
        if (!node) { continue; }

        nodes.push(node);

        // get links DOM element from nodes, if their target is not hidden
        let sources = document.querySelectorAll('[data-source="' + nodeId + '"]');
        sources = Array.from(sources);
        sources = sources.filter(function(source) {
            if (diplayedNodes.indexOf(Number(source.dataset.target)) !== -1) {
                return true;
            }
        })

        // get links DOM element to nodes, if their source is not hidden
        let targets = document.querySelectorAll('[data-target="' + nodeId + '"]');
        targets = Array.from(targets);
        targets = targets.filter(function(source) {
            if (diplayedNodes.indexOf(Number(source.dataset.source)) !== -1) {
                return true;
            }
        })

        links = links.concat(sources, targets);
    }

    // delete duplicated links DOM element
    links = links.filter((item, index) => {
        return links.indexOf(item) === index
    });

    return nodes.concat(links);
}

/**
 * Hide some nodes &amp; their links, by their id
 * @param {array} nodeIds - List of nodes ids
 */

function hideNodes(nodeIds) {
    let nodesToHide = index.filter(function(item) {
        if (nodeIds.indexOf(item.id) !== -1 &amp;&amp; item.hidden === false) {
            // return nodes are not yet hidden…
            if (view.isolateMode) {
                if (item.isolated === true) { return true; } // … and part of the isolated ones
            } else {
                return true;
            }
        }
        return false;
    }).map(item => item.id);

    hideFromIndex(nodesToHide);
    const elts = getNodeNetwork(nodesToHide);
    if (elts.length === 0) { return; }

    for (const elt of elts) {
        elt.style.display = 'none';
    }

    index = index.map(function(item) {
        if (nodesToHide.indexOf(item.id) !== -1) {
            item.hidden = true; // for each nodesToHide
        }
        return item;
    });
}

/**
 * Display some nodes &amp; their links, by their id
 * @param {array} nodeIds - List of nodes ids
 */

function displayNodes(nodeIds) {
    let nodesToDisplay = [];

    index = index.map(function(item) {
        if (nodeIds.indexOf(item.id) !== -1 &amp;&amp; item.hidden === true) {
            // push on nodesToDisplay nodes are not yet displayed…
            if (view.isolateMode) {
                if (item.isolated === true) { // … and part of the isolated ones
                    item.hidden = false;
                    nodesToDisplay.push(item.id);
                }
            } else {
                item.hidden = false;
                nodesToDisplay.push(item.id);
            }
        }
        return item;
    });

    displayFromIndex(nodesToDisplay);
    const elts = getNodeNetwork(nodesToDisplay);
    if (elts.length === 0) { return; }

    for (const elt of elts) {
        elt.style.display = null;
    }
}</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.6</a> on Mon May 03 2021 11:53:24 GMT+0200 (heure d’été d’Europe centrale) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
